[SB16] HÆ°á»›ng dáº«n sá»­ dá»¥ng @ConfigurationPropertie
=========================================================

The Wayback Machine - https://web.archive.org/web/20230602183126/https://loda.me/articles/sb16-huong-dan-su-dung-configurationpropertie

![Logo](https://web.archive.org/web/20230602183126im_/https://super-static-assets.s3.amazonaws.com/8a72ee8e-d4aa-4a06-985f-e92802c5bc44/uploads/logo/36872858-1bc0-4117-bb6b-81d9934b5275.svg)

- Home
- KhÃ³a há»c
- #dalog

Created

Oct 27, 2021 3:33 PM

- Giá»›i thiá»‡u
- CÃ i Ä‘áº·t
- Cáº¥u hÃ¬nh Ä‘Æ¡n giáº£n
- Cháº¡y thá»­
- Nested Properties
- Link Github

### **Giá»›i thiá»‡u**

Tiáº¿p ná»‘i Series,Â báº¯t Ä‘áº§u tá»« bÃ i viáº¿t trÆ°á»›c, báº¡n hoÃ n toÃ n Ä‘Ã£ cÃ³ thá»ƒ lÃ m chá»§ Spring Boot cho nghiá»‡p vá»¥ cá»§a mÃ¬nh rá»“i. Trong cÃ¡c pháº§n sáº¯p tá»›i sáº½ lÃ  cÃ¡c kiáº¿n thá»©c nÃ¢ng cao hÆ¡n Ä‘á»ƒ giÃºp báº¡n tÄƒng hiá»‡u quáº£ trong code.

1. [ğŸš‰\
\SB15\] Exception Handling @ExceptionHandler + @RestControllerAdvice / @ControllerAdvice + @ResponseStatus

Má»™t trong nhá»¯ng Ä‘iá»ƒm tiá»‡n dá»¥ng cá»§aÂ **Spring Boot**Â lÃ  nÃ³ cho phÃ©p chÃºng ta cáº¥u hÃ¬nh á»©ng dá»¥ng tá»« bÃªn ngoÃ i vÃ  láº¥y cÃ¡c thÃ´ng tin Ä‘Ã³ ra má»™t cÃ¡ch dá»… dÃ ng.

Trong bÃ i hÃ´m nay chÃºng ta sáº½ tÃ¬m hiá»ƒu annotationÂ `@ConfigurationProperties`, má»™t trong nhá»¯ng cÃ¡ch khoa há»c nháº¥t mÃ  báº¡n nÃªn sá»­ dá»¥ng cho á»©ng dá»¥ng cá»§a mÃ¬nh.

### **CÃ i Ä‘áº·t**

_pom.xml_

```
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0http://maven.apache.org/xsd/maven-4.0.0.xsd">
  <modelVersion>4.0.0</modelVersion>
  <packaging>pom</packaging>

  <parent>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-parent</artifactId>
    <version>2.1.4.RELEASE</version>
    <relativePath /> <!-- lookup parent from repository -->
  </parent>
  <groupId>me.loda.spring</groupId>
  <artifactId>spring-boot-learning</artifactId>
  <version>0.0.1-SNAPSHOT</version>
  <name>spring-boot-learning</name>
  <description>Everything about Spring Boot</description>

  <properties>
    <java.version>1.8</java.version>
  </properties>

  <dependencies>
    <dependency>
      <groupId>org.springframework.boot</groupId>
      <artifactId>spring-boot-starter-web</artifactId>
    </dependency>

    <dependency>
      <groupId>org.projectlombok</groupId>
      <artifactId>lombok</artifactId>
      <optional>true</optional>
    </dependency>
  </dependencies>

  <build>
    <plugins>
      <plugin>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-maven-plugin</artifactId>
      </plugin>
    </plugins>
  </build>

</project>
```

Cáº¥u trÃºc thÆ° má»¥c:

!image

### **Cáº¥u hÃ¬nh Ä‘Æ¡n giáº£n**

Giáº£ sá»­, á»©ng dá»¥ng cá»§a tÃ´i sáº½ yÃªu cáº§u cÃ³ má»™t sá»‘ giÃ¡ trá»‹ toÃ n cá»¥c, mÃ  thay vÃ¬ cáº¥u hÃ¬nh á»Ÿ trong code, tÃ´i muá»‘n lÆ°u nÃ³ á»Ÿ bÃªn ngoÃ i, Ä‘á»ƒ tiá»‡n thay Ä‘á»•i má»—i khi cáº§n.

ThÃ¬ tÃ´i sáº½ lÃ m nhÆ° sau, táº¡o ra má»™t class chá»©a cÃ¡c thÃ´ng tin:

```
@Data // Lombok, xem chi tiáº¿t táº¡i bÃ i viáº¿t
@Component // LÃ  1 spring bean
// @PropertySource("classpath:loda.yml") // ÄÃ¡nh dáº¥u Ä‘á»ƒ láº¥y config tá»« trong file loda.yml
@ConfigurationProperties(prefix = "loda") // Chá»‰ láº¥y cÃ¡c config cÃ³ tiá»n tá»‘ lÃ  "loda"
public class LodaAppProperties {
    private String email;
    private String googleAnalyticsId;

    // standard getters and setters
}
```

ChÃºng ta sá»­ dá»¥ngÂ `@Component`Â Ä‘á»ƒ Spring biáº¿t Ä‘Ã¢y lÃ  má»™t bean vÃ  khá»Ÿi táº¡o nÃ³.

Sá»­ dá»¥ngÂ `@PropertySource`Â Ä‘á»ƒ Ä‘á»‹nh nghÄ©a tÃªn cá»§a file config. Náº¿u khÃ´ng cÃ³ annotation nÃ y, Spring sáº½ sá»­ dá»¥ng file máº·c Ä‘á»‹nh (_classpath:application.yml_Â trong thÆ° má»¥cÂ _resources_)

Cuá»‘i cÃ¹ng lÃ Â `@ConfigurationProperties`, annotation nÃ y Ä‘Ã¡nh dáº¥u class bÃªn dÆ°á»›i nÃ³ lÃ  properties, cÃ¡c thuá»™c tÃ­nh sáº½ Ä‘Æ°á»£c tá»± Ä‘á»™ng náº¡p vÃ o khi Spring khá»Ÿi táº¡o.

LÆ°u Ã½: cÃ¡c thuá»™c tÃ­nh nÃ y Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh bá»ŸiÂ `prefix=loda`. CÃ¡i nÃ y báº¡n xem fileÂ _application.yml_Â á»Ÿ dÆ°á»›i sáº½ hiá»ƒu.

Spring sáº½ tá»± tÃ¬m cÃ¡c hÃ m setter Ä‘á»ƒ set giÃ¡ trá»‹ cho cÃ¡c thuá»™c tÃ­nh nÃ y, nÃªn quan trá»ng lÃ  báº¡n pháº£i táº¡o ra cÃ¡c setter method. (á» Ä‘Ã¢y tÃ´i nhÆ°á»ng viá»‡c Ä‘Ã³ choÂ lombok).

NgoÃ i ra, Ä‘á»ƒ cháº¡y Ä‘Æ°á»£c tÃ­nh nÄƒng nÃ y, báº¡n cáº§n kÃ­ch hoáº¡t nÃ³ báº±ng cÃ¡ch gáº¯nÂ `@EnableConfigurationProperties`Â lÃªn má»™t configuration nÃ o Ä‘Ã³. á» Ä‘Ã¢y tÃ´i gáº¯n lÃªn hÃ m main luÃ´n.

```
@SpringBootApplication
@EnableConfigurationProperties
public class App {
    public static void main(String[] args) {
        SpringApplication.run(App.class, args);
    }
}
```

Váº­y lÃ  xong, Ä‘Æ¡n giáº£n pháº£i khÃ´ng. BÃ¢y giá»,Â **Spring sáº½ tá»± Ä‘á»™ng bind toÃ n bá»™ giÃ¡ trá»‹ tá»« trong file**_**application.yml**_**vÃ o bean**_**LodaAppProperties**_**cho chÃºng ta.**

Táº¡o ra fileÂ _application.yml_Â táº¡i thÆ° má»¥c resources:

!image

ThÃªm cÃ¡c thÃ´ng tin chÃºng ta cáº§n:

```
loda:
  email: loda.namnh@gmail.com
  googleAnalyticsId: U-xxxxx
```

ChÃºng ta pháº£i Ä‘áº·t cÃ¡c thuá»™c tÃ­nh nÃ y sau prefixÂ _loda_

### **Cháº¡y thá»­**

Teedeee, tháº¿ lÃ  xong, ráº¥t Ä‘Æ¡n giáº£n, Ä‘á»ƒ kiá»ƒm nghiá»‡m xem Spring Ä‘Ã£ nháº­n cÃ¡c thÃ´ng sá»‘ cáº¥u hÃ¬nh nÃ y chÆ°a. ChÃºng ta sáº½ in ra:

```
@SpringBootApplication
@EnableConfigurationProperties
public class App implements CommandLineRunner {
    public static void main(String[] args) {
        SpringApplication.run(App.class, args);
    }

    @Autowired LodaAppProperties lodaAppProperties;

    @Override
    public void run(String... args) throws Exception {
        System.out.println("Global variable:");
        System.out.println("\t Email: "+lodaAppProperties.getEmail());
        System.out.println("\t GA ID: "+lodaAppProperties.getGoogleAnalyticsId());
    }
}
```

Káº¿t quáº£:

```
Global variable:
	 Email: loda.namnh@gmail.com
	 GA ID: U-xxxxx
```

BÃ¢y giá», á»Ÿ báº¥t ká»³ Ä‘Ã¢u trong chÆ°Æ¡ng trÃ¬nh, khi cáº§n láº¥y cÃ¡c thÃ´ng tin config, tÃ´i chá»‰ cáº§n:

```
@Autowired LodaAppProperties lodaAppProperties;
```

lÃ  xong.

### **Nested Properties**

ChÃºng ta cÃ³ thá»ƒ config cÃ¡c thuá»™c tÃ­nh bÃªn trong Class ká»ƒ cáº£ khi nÃ³ lÃ Â `Lists`,Â `Maps`Â hay má»™t class khÃ¡c.

Bá»• sung thÃªm thuá»™c tÃ­nh:

```
@Data // Lombok, xem chi tiáº¿t táº¡i bÃ i viáº¿t
@Component // LÃ  1 spring bean
//@PropertySource("classpath:loda.yml") // ÄÃ¡nh dáº¥u Ä‘á»ƒ láº¥y config tá»« trong file loda.yml
@ConfigurationProperties(prefix = "loda") // Chá»‰ láº¥y cÃ¡c config cÃ³ tiá»n tá»‘ lÃ  "loda"
public class LodaAppProperties {
    private String email;
    private String googleAnalyticsId;

    private List<String> authors;

    private Map<String, String> exampleMap;

    // standard getters and setters
}
```

Sá»­a fileÂ _application.yml_:

```
loda:
  email: loda.namnh@gmail.com
  googleAnalyticsId: U-xxxxx
  authors:
    - loda
    - atom
  exampleMap:
    key1: hello
    key2: world
```

Cháº¡y láº¡i chÆ°Æ¡ng trÃ¬nh:

```
@Override
public void run(String... args) throws Exception {
    System.out.println("Global variable:");
    System.out.println("\t Email: " + lodaAppProperties.getEmail());
    System.out.println("\t GA ID: " + lodaAppProperties.getGoogleAnalyticsId());
    System.out.println("\t Authors: " + lodaAppProperties.getAuthors());
    System.out.println("\t Example Map: " + lodaAppProperties.getExampleMap());
}
```

Káº¿t quáº£:

```
Global variable:
	 Email: loda.namnh@gmail.com
	 GA ID: U-xxxxx
	 Authors: [loda, atom]
	 Example Map: {key1=hello, key2=world}
```

### **Link Github**

ChÃºng ta Ä‘Ã£ tÃ¬m hiá»ƒu cÃ¡ch sá»­ dá»¥ng annotationÂ `@ConfigurationProperties`Â vÃ  cÃ¡c á»©ng dá»¥ng cá»§a nÃ³. Ãp dá»¥ng cÃ¡ch config nÃ y sáº½ giÃºp báº¡n kiá»ƒm soÃ¡t tá»‘t hÆ¡n vÃ  sá»­ dá»¥ng dá»… hÆ¡n.

ğŸ’Â Náº¿u cÃ³, toÃ n bá»™ project / code máº«u Ä‘Æ°á»£c lÆ°u trá»¯ táº¡i **GitHub**

ğŸŒŸÂ ÄÃ¢y lÃ  má»™t bÃ i viáº¿t trongÂ Series **LÃ m chá»§ Spring Boot â€“ Zero to Hero**

_Náº¿u báº¡n phÃ¡t hiá»‡n bÃ i viáº¿t cÃ³ lá»—i hoáº·c outdated, hÃ£y bÃ¡o láº¡i giÃºp mÃ¬nh theo email:__loda.namnh@gmail.com__hoáº·c qua__Nam HoÃ ng Nguyá»…n (facebook.com)_





